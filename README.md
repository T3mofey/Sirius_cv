В данном репозитории лежит выолненый кейс от Сириуса по теме computer vision. Вкратце нужно удалить фон, заменить его и затем описать объекты. 
Для удаления фона использовались готовые модели: BriaAI, nvidia segmentation и mattmdjaga. Их ссылкаи на huggingface соответственно: 
https://huggingface.co/briaai/RMBG-1.4 

https://huggingface.co/nvidia/segformer-b0-finetuned-ade-512-512

https://huggingface.co/mattmdjaga/segformer_b2_clothes

Также использовалось удаление фона с помощью библиотеки OpenCV. Реализовано в opencv_seg.py 

Для замены фона использовался градиентный фон, написанный собственноручно(функция def gradient_texture в файле applying_back.py). Выбор цветов замены фона: белый, серый, ярко-серый и темно-серый. Для замены фона маски от готовой модели сохранялись в отдельный файл.

Для определения точности моделей, все модели сравнивались с главной моделью, которой я выбрал BriaAI, так как по результатм сегментации, на глаз показалось, что он выделяет лучше всего.
Обработка каждой модели( то есть выделение масок) производится для каждой в отдельном файле с соответсвующими названия(разрешение .py).

Соответствующие им файлы:

cv_task_redone.py

nvidia_segmentation.py

matt_model.py

Каждый из этих кодов возвращает папку с масками для каждой картинки.

Для непосредственного расчета точности удаления фона использовались метрики: Intersection over union(IoU) и Dice coefficient(F1-score).

Расчет метрик лежит в файле Score.py

Наложение фона проводится в файле applying_back.py. Для просмотра того, как накладывается фон у разных моделей нужно поменять mask_dir на директорию с масками нужной модели.

Для описания картинок использовалась модель - Salesforce/blip-image-captioning-large.
Ссылка на Huggingface:

https://huggingface.co/Salesforce/blip-image-captioning-large

Описание приводилось только для картинок, обработанных моделью BriaAI. Код выполняющий описание называется captioning.py. Картинки с генерированным описанием под ними лежит в папке images_with_captions.

Так же можно посмотреть как все модели сегментации выполняют свою задачу в соответствующих папках начинающихся с resulted_images. Proccessed_images1 это результат работы briaai и resulted_images тоже.

ПАПКА assignment1 не относится к задаче. 

